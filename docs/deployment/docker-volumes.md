# Docker Volumes –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Ä–µ–¥–µ–ø–ª–æ–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ, –∑–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ) –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ **—É–¥–∞–ª—è—é—Ç—Å—è**. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ª–æ–≥–∏ —Ç–µ—Ä—è—é—Ç—Å—è.

## –†–µ—à–µ–Ω–∏–µ: Docker Volumes

Docker Volumes –ø–æ–∑–≤–æ–ª—è—é—Ç —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ **–≤–Ω–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**, —á—Ç–æ–±—ã –æ–Ω–∏ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏.

---

## –í–∞—Ä–∏–∞–Ω—Ç 1: Named Volume (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞) ‚úÖ

### –ß—Ç–æ —ç—Ç–æ?

Docker —Å–æ–∑–¥–∞—ë—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –∫–æ—Ç–æ—Ä–æ–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è Docker'–æ–º –∏ –∂–∏–≤—ë—Ç –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É —Ä–µ–¥–µ–ø–ª–æ—è–º–∏
- ‚úÖ Docker —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π cleanup)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö (Linux, macOS, Windows)
- ‚úÖ –ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –±—ç–∫–∞–ø–∏—Ç—å –∏ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå –õ–æ–≥–∏ –Ω–µ –≤–∏–¥–Ω—ã –Ω–∞–ø—Ä—è–º—É—é –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ —Ö–æ—Å—Ç–∞
- ‚ùå –ù—É–∂–Ω—ã Docker –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

```yaml
services:
  currency-bot:
    volumes:
      - currency-bot-logs:/app/logs

volumes:
  currency-bot-logs:
    driver: local
```

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

#### –ó–∞–ø—É—Å–∫
```bash
docker-compose up -d
```

#### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –°–ø–æ—Å–æ–± 1: –ü—Ä–æ—Å–º–æ—Ç—Ä —á–µ—Ä–µ–∑ docker logs (–ª–æ–≥–∏ –∏–∑ stdout)
docker logs -f currency-bot

# –°–ø–æ—Å–æ–± 2: –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª—ã –∏–∑ volume
docker exec currency-bot cat /app/logs/currency-bot.log

# –°–ø–æ—Å–æ–± 3: –°–ª–µ–¥–∏—Ç—å –∑–∞ —Ñ–∞–π–ª–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker exec currency-bot tail -f /app/logs/currency-bot.log

# –°–ø–æ—Å–æ–± 4: –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ –Ω–∞ —Ö–æ—Å—Ç
docker cp currency-bot:/app/logs/currency-bot.log ./local-logs.log
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ volume
```bash
# –°–ø–∏—Å–æ–∫ volumes
docker volume ls

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ volume
docker volume inspect currency-bot-logs

# –ì–¥–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–≥–∏
docker volume inspect currency-bot-logs | grep Mountpoint
```

#### –†–µ–¥–µ–ø–ª–æ–π —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ª–æ–≥–æ–≤
```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose down

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–π (–ª–æ–≥–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è!)
docker-compose up -d

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ª–æ–≥–∏ –Ω–∞ –º–µ—Å—Ç–µ
docker exec currency-bot ls -lah /app/logs/
```

#### Backup –ª–æ–≥–æ–≤
```bash
# –°–æ–∑–¥–∞—Ç—å backup
docker run --rm \
  -v currency-bot-logs:/source \
  -v $(pwd):/backup \
  alpine tar czf /backup/logs-backup-$(date +%Y%m%d).tar.gz -C /source .

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å backup
docker run --rm \
  -v currency-bot-logs:/target \
  -v $(pwd):/backup \
  alpine tar xzf /backup/logs-backup-20250130.tar.gz -C /target
```

#### –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
```bash
# –£–¥–∞–ª–∏—Ç—å –ª–æ–≥–∏ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
docker exec currency-bot find /app/logs -name "*.log" -mtime +30 -delete

# –ò–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—Å—Ç–∏—Ç—å volume (–û–°–¢–û–†–û–ñ–ù–û!)
docker-compose down
docker volume rm currency-bot-logs
docker-compose up -d
```

---

## –í–∞—Ä–∏–∞–Ω—Ç 2: Bind Mount (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) üõ†Ô∏è

### –ß—Ç–æ —ç—Ç–æ?

–ú–æ–Ω—Ç–∏—Ä—É–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å —Ö–æ—Å—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä. –õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ –≤–∞—à—É —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –õ–æ–≥–∏ –≤–∏–¥–Ω—ã –Ω–∞–ø—Ä—è–º—É—é –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ (`./logs/`)
- ‚úÖ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ö–æ—Å—Ç–∞ (grep, less, IDE)
- ‚úÖ –£–¥–æ–±–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- ‚ùå –ú–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ Linux)
- ‚ùå –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã —Ö–æ—Å—Ç–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í `docker-compose.yml` –∑–∞–º–µ–Ω–∏:
```yaml
volumes:
  # –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π named volume
  # - currency-bot-logs:/app/logs

  # –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π bind mount
  - ./logs:/app/logs
```

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

#### –ó–∞–ø—É—Å–∫
```bash
# –°–æ–∑–¥–∞–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –Ω–∞ —Ö–æ—Å—Ç–µ
mkdir -p ./logs

# –ó–∞–ø—É—Å—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose up -d
```

#### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –ü—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä–æ–π —Ñ–∞–π–ª!
cat ./logs/currency-bot.log

# –°–ª–µ–¥–∏—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f ./logs/currency-bot.log

# Grep –ø–æ –ª–æ–≥–∞–º
grep ERROR ./logs/currency-bot.log

# –û—Ç–∫—Ä—ã—Ç—å –≤ IDE
code ./logs/currency-bot.log
```

#### –†–µ–¥–µ–ø–ª–æ–π
```bash
# –õ–æ–≥–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –≤ ./logs/ –ø–æ—Å–ª–µ —Ä–µ–¥–µ–ø–ª–æ—è
docker-compose down
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä—å
ls -lah ./logs/
```

---

## –í–∞—Ä–∏–∞–Ω—Ç 3: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ üî•

–î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≥–∏–±–∫–æ—Å—Ç–∏ –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:

### docker-compose.yml
```yaml
services:
  currency-bot:
    volumes:
      - ${LOGS_VOLUME:-currency-bot-logs}:/app/logs

volumes:
  currency-bot-logs:
    driver: local
```

### .env
```bash
# –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞ - –∏—Å–ø–æ–ª—å–∑—É–π named volume (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
# LOGS_VOLUME –Ω–µ —É–∫–∞–∑—ã–≤–∞–π

# –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ - –∏—Å–ø–æ–ª—å–∑—É–π bind mount
LOGS_VOLUME=./logs
```

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π                | Named Volume | Bind Mount |
|-------------------------|--------------|------------|
| –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ —Ä–µ–¥–µ–ø–ª–æ–µ | ‚úÖ           | ‚úÖ         |
| –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞ —Ö–æ—Å—Ç–µ       | ‚ùå           | ‚úÖ         |
| –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å    | ‚úÖ           | ‚ö†Ô∏è         |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Docker       | ‚úÖ           | ‚ùå         |
| Backup/Restore          | –°—Ä–µ–¥–Ω–µ       | –õ–µ–≥–∫–æ      |
| –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞           | –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º  | –ú–æ–≥—É—Ç –±—ã—Ç—å |
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**        | **–ü—Ä–æ–¥–∞–∫—à–Ω** | **Dev**    |

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–∑–º–µ—Ä–∞ –ª–æ–≥–æ–≤

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä volume
```bash
docker system df -v | grep currency-bot-logs
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
```bash
docker exec currency-bot du -sh /app/logs
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ (cron)

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å cron –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏:
```bash
# –û—Ç–∫—Ä—ã—Ç—å crontab
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 —É–¥–∞–ª—è—Ç—å –ª–æ–≥–∏ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
0 3 * * * docker exec currency-bot find /app/logs -name "*.log" -mtime +30 -delete
```

---

## Troubleshooting

### –õ–æ–≥–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ —Ä–µ–¥–µ–ø–ª–æ—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ volume —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
docker volume ls | grep currency-bot-logs

# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ volume —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
docker inspect currency-bot | grep Mounts -A 10
```

### –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–æ–≥–∞–º (bind mount –Ω–∞ Linux)
```bash
# –ü—Ä–æ–±–ª–µ–º–∞: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–∏—à–µ—Ç –æ—Ç –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
# –†–µ—à–µ–Ω–∏–µ: –¥–∞–π –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
sudo chown -R 1000:1000 ./logs

# –ò–ª–∏ —Å–¥–µ–ª–∞–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–æ—Å—Ç—É–ø–Ω–æ–π –≤—Å–µ–º
chmod 777 ./logs
```

### Volume –∑–∞–Ω–∏–º–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞
```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏ —Ä–∞–∑–º–µ—Ä
docker system df -v

# –û—á–∏—Å—Ç–∏ —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏
docker exec currency-bot find /app/logs -name "*.log" -mtime +7 -delete

# –ò–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏ volume
docker-compose down
docker volume rm currency-bot-logs
docker-compose up -d
```

---

## Best Practices

1. **–ü—Ä–æ–¥–∞–∫—à–Ω**: –∏—Å–ø–æ–ª—å–∑—É–π named volume
2. **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: –∏—Å–ø–æ–ª—å–∑—É–π bind mount
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π —Ä–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤
4. **Backup**: –¥–µ–ª–∞–π —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –ª–æ–≥–æ–≤ –ø–µ—Ä–µ–¥ –º–∞–∂–æ—Ä–Ω—ã–º–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏
5. **–†–æ—Ç–∞—Ü–∏—è**: –Ω–∞—Å—Ç—Ä–æ–π logback –Ω–∞ —Ä–æ—Ç–∞—Ü–∏—é (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ - 30 –¥–Ω–µ–π, 1GB)
6. **–í–Ω–µ—à–Ω–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**: –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π ELK, CloudWatch, Datadog
